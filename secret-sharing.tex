\documentclass[12pt, a4paper, oneside, titlepage]{report}

\usepackage{ngerman}
\usepackage[utf8]{inputenc}
\usepackage[T1]{fontenc}
\usepackage{latexsym}
\usepackage{amsmath,amsfonts,amssymb,amsthm,amscd}
\usepackage{dsfont}
\usepackage{graphicx}
\usepackage[flushleft]{paralist} 
\usepackage[dvipsnames]{xcolor} 
\usepackage[all]{xy}
\usepackage{makeidx}
\usepackage{graphicx}
\usepackage{verbatim}
\usepackage[numbers]{natbib} % [numbers,round]

\usepackage{pgf}
\usepackage{tikz}
\usepackage{pgfplots}
\usepackage{mathrsfs}
\usepackage{adjustbox}

\usetikzlibrary{arrows}
\pgfplotsset{compat=1.15}

\usepackage{hyperref}

\newcommand{\R}{\mathds{R}}
\newcommand{\Z}{\mathds{Z}}
\newcommand{\N}{\mathds{N}}
\newcommand{\Q}{\mathds{Q}}
\newcommand{\K}{\mathds{K}}
\newcommand{\C}{\mathds{C}}
\newcommand{\B}{\mathds{B}}
\newcommand{\F}{\mathds{F}}
\newcommand{\p}{\mathfrak{p}}
\newcommand{\Pot}{\mathcal{P}}
\newcommand{\id}{\textup{id}}
\newcommand{\Ker}{\textup{Ker}}
\newcommand{\Image}{\textup{Im}}
\newcommand{\la}{\langle}
\newcommand{\ra}{\rangle}

\newtheorem{lemma}{Lemma}[section]
\newtheorem{prop}[lemma]{Proposition}
\newtheorem{defprop}[lemma]{Definition and Proposition}
\newtheorem{satz}[lemma]{Satz}
\newtheorem{thm}[lemma]{Theorem} 
\newtheorem{kor}[lemma]{Korollar} 
\newtheorem{folg}[lemma]{Folgerung}
\newtheorem{verm}[lemma]{Vermutung}
\newenvironment{bew}{\begin{proof}[Beweis]}{\end{proof}}
\theoremstyle{definition} 
\newtheorem{def1}[lemma]{Definition} 
\newtheorem{bem}[lemma]{Bemerkung}
\newtheorem{bsp}[lemma]{Beispiel}
\newtheorem{notation}[lemma]{Notation}

\renewcommand\thesection{\arabic{section}}

\author{Henning Hontheim}
\title{Secret Sharing}
\date{10. März 2020}

\let\svthefootnote\thefootnote
\newcommand\blankfootnote[1]{%
	\let\thefootnote\relax\footnotetext{#1}%
	\let\thefootnote\svthefootnote%
}

\begin{document}
	\maketitle
	\tableofcontents
	\blankfootnote{Allein aus Gr"unden der Lesbarkeit wird auf die gleichzeitige Verwendung mehrerer geschlechtsspezifischer Sprachformen verzichtet. S"amtliche Personenbezeichnungen gelten f"ur alle Geschlechter.}
	\clearpage
	
	\section{Wozu Secret Sharing?}
	Arbeiten Sie mit Anderen an einem geheimen Projekt, so gibt es einige Herausforderungen zu meistern. Was passiert, wenn Sie Ihren Schlüssel der verschlüsselten Daten verlieren? Haben nur Sie einen Schlüssel? Wahrscheinlich nicht. Es ist nützlich, seien es in einem Tresor verschlüsselte Daten, oder die privaten Schlüssel in einer PKI, wenn nicht nur Sie den einzigen Schlüssel besitzen.
	
	Aber wie teilen Sie den Zugriff auf die Daten? Wenn Sie Ihren Schlüssel vervielfältigen würden, hätte ein Einzelner Vollzugriff. Es wäre besser, wenn es mehrere Personen benötigen würde, um Zugriff zu erhalten -- idealerweise mehr als die Hälfte aller Beteiligten. Doch wie lässt es sich in der Praxis umsetzen, dass es mehrere Personen benötigt um einen privaten Schlüssel zu rekonstruieren?
	
	Ich möchte hier eine Technik vorstellen, die es erlaubt, Geheimnisse mit anderen zu teilen -- das Secret Sharing. Siehe \cite{buchmann} und \cite{shamir}.
	
	% In Public-Key-Infrastrukturen ist es oft nützlich, private Schlüssel von Teilnehmern rekonstruieren zu können. Wenn nämlich ein Benutzer die Chipkarte mit seinem geheimen Schlüssel verliert, kann er seine verschlüsselt gespeicherten Daten nicht mehr entschlüsseln. Aus Sicherheitsgründen ist es aber wichtig, dass nicht ein einzelner die Möglichkeit hat, geheime Schlüssel zu rekonstruieren. Es ist besser, wenn bei der Rekonstruktion von privaten Schlüsseln mehrere Personen zusammenarbeiten müssen. Die können sich dann gegenseitig kontrollieren. Die Wahrscheinlichkeit sinkt, dass Unberechtigte Zugang zu geheimen Schlüsseln bekommen. In diesem Kapitel wird eine Technik vorgestellt, dieses Problem zu lösen, das Secret-Sharing. \cite{buchmann} \cite{shamir}
	
	\subsection{Ein kombinatorisches Beispiel}
	
	Mehrere Wissenschaftler $ N $ arbeiten zusammen an einem Geheimprojekt. Um die Dokumente geheim zu halten und um Missbrauch vorzubeugen, verschließen sie diese in einem Tresor. Nur wenn mindestens die Hälfte aller Wissenschaftler anwesend ist, soll sich der Tresor öffnen lassen. Wie viele paarweise verschiedene Schlösser $ S $ muss der Tresor mindestens besitzen? Wie viele paarweise verschiedene Schlüssel $ s $ muss jeder Wissenschaftler mindestens bei sich tragen? Siehe \cite{shamir} nach \cite{liu}.
	
	\begin{bsp}
		Sei $ N = 11 $ die Anzahl aller Wissenschaftler und $ n = \left\lceil\frac{N}{2} \right\rceil = 6 $ die Anzahl derer, die mindestens anwesend sein müssen, damit sich der Tresor öffnen lässt. Folglich muss es also für jede Teilmenge mit $ k $ Wissenschaftlern, wobei $ k = N - n = 5 $, genau ein Schloss geben, für das keiner der $ k $ Wissenschaftler einen Schlüssel besitzt. Also muss der Tresor $ S = \binom{N}{k} = \binom{11}{5} = 462 $ paarweise verschiedene Schlösser besitzen.
		
		Sei $ W = \{w_1, w_2, \dots w_k, w_{k+1}\} $ mit $ |W| = k + 1 = 6 $ die Menge von Wissenschaftlern, die mindestens benötigt wird, um den Tresor zu öffnen. Dann gibt es genau ein bestimmtes Schloss $ S' $, für das keiner der Wissenschaftler aus $ W \setminus w_{k+1} $ einen Schlüssel besitzt, der Wissenschaftler $ w_{k+1} $ jedoch schon. Da für jede Permutation von $ k = 5 $ Wissenschaftlern genau der $ w_{k+1} $ existiert, der die Teilmenge $ W $ \glqq vervollständigt\grqq, bekommt jeder Wissenschaftler $ s = \binom{N-1}{|W|-1} = \binom{N-1}{k} = \binom{10}{5} = 252 $ Schlüssel. Das ergibt eine Gesamtanzahl an $ 11 \cdot 252 = 2772 $ Schlüsseln. Dass dies keine praktikable Lösung des Problems ist, ist offensichtlich.
	\end{bsp}
	\section{Primitives Secret Sharing}
	\subsection{Aufsplitten des Secrets}
		Ein primitives Vorgehen zur Aufteilung eines Geheimnisses wäre es, dieses nach einer gewissen Anzahl Stellen zu trennen.
		\begin{bsp}
			Sei $ D = 14561237 $ das Geheimnis, welchen unter 2 Personen aufgeteilt werden soll. Bei 8 Stellen, könnte man der ersten Person $ P_1 $ die ersten 4 Stellen, der zweiten Person $ P_2 $ die letzten 4 Stellen zuteilen.
			$$ D = 14561237 = \underset{=:D_1}{\underline{1\,4\,5\,6}} \, \underset{=:D_2}{\underline{1\,2\,3\,7}} = D_1 \cdot 10^4 + D_2 $$
		\end{bsp}
		Der entscheidende Nachteil hierbei ist, dass die Shares\footnote{Shares sind die Bestandteile eines Geheimnisses, die zur Rekonstruktion dessen an die beteiligten Personen aufgeteilt werden} $ D_1 $ und $ D_2 $ Aufschluss über die Beschaffenheit von $ D $ geben. Wer $ D_1 $ besitzt braucht nur $ 10^4 $ Kombinationen zu testen, wohingegen ein unbeteiligter Dritter $ 10^8 $ ausprobieren müsste.
		
		Fortan fordern wir also, dass es eine wichtige Eigenschaft der Shares sein muss, keine Informationen über das Geheimnis $ D $ preiszugeben, und alle Möglichkeiten von $ D $ gleich wahrscheinlich sein sollen.
		
	\subsection{One-Time-Padding}
		 Ein Verfahren, welches die geforderte Eigenschaft nicht verletzt, ist das sogenannte One-Time-Padding. Hierbei wird eine zufällige Zahl $ r $ zu unserem Geheimnis $ D $  addiert, die beide die gleiche Stellenanzahl haben müssen. % \pagebreak % TODO REMOVE!!!
	
	\begin{bsp}
		Sei wieder $ D = 14561237 $ und ein $ r_1 = 81613241 $ zufällig gewählt. Nun berechnen wir $ r_2 = D \oplus r_1 $, wobei wir hier $ \oplus $ die Addition ist, die Überträge vernachlässigt.
	
	\begin{equation}
		\begin{tabular}{crl}
		  &14561237&$ = D $\\\
		$\oplus$&81613241&$ = r_1 $\\\hline
		  &95174478&$ = r_2 $
		\end{tabular}
	\end{equation}
	% TODO Zeile frei?
	
	Nun können wir das Geheimnis rekonstruieren, wenn wir $ D = r_2 \ominus r_1 $ stellenweise rechnen. Unsere Subtraktion $ \ominus $ ignoriert auch hier wieder für jede Stelle den (negativen) Übertrag. Somit wäre beispielsweise $ 1 \ominus 6 = + 5 $.
	
	\begin{equation}
	\begin{tabular}{crl}
	&95174478&$ = r_2 $\\
	$\ominus$&81613241&$ = r_1 $\\\hline
	&14561237&$ = D $
	\end{tabular}
	\end{equation}
	
	Wenn wir nun zwei Personen haben, die $ D $ unter sich aufteilen möchten, erhält $ P_1 $ den Share $ r_1 = 81613241 $ und $ P_2 $ den Share $ r_2 = 95174478$. Beide Shares geben keinerlei Aufschluss über die Beschaffenheit von $ D $. Zusammen können $ P_1 $ und $ P_2 $ das Geheimnis jedoch rekonstruieren.
	\end{bsp}

	\begin{bsp}
		Ein weiteres Beispiel % TODO Visuelles Beispiel
	\end{bsp}

	Wie sieht das Ganze jedoch aus, wenn sich mehr als zwei Personen ein Geheimnis teilen möchten? Auch dies ist möglich für eine beliebige Anzahl $ N $ an Personen. Doch was passiert, wenn einer der Beteiligten den eigenen Share verliert? Da alle Shares benötigt werden um $ D $ zu rekonstruieren, ist das unser SPOF\footnote{Single Point of Failure}. Da dies in der Praxis für große $ N $ sehr schnell zu einem Problem führen kann, möchten wir dieses Verfahren hier nicht länger behandeln.


	
	\section{Shamir's Secret Sharing}
		Blah % TODO Shamir's
		
	\subsection{$ (2,n) $-Schema}
		Blah % TODO (2,n) $-Schema
		
		\begin{figure}[h]
		\begin{adjustbox}{center}
			\begin{tikzpicture}[line cap=round,line join=round,>=triangle 45,x=0.015cm,y=0.015cm]
				\begin{axis}[x=0.015cm,y=0.015cm,axis lines=middle,ymajorgrids=true,xmajorgrids=true,
				xmin=-150.,xmax=850.,xtick={-100.,0.,...,850.},
				ymin=-150.,ymax=550.,ytick={-100.,0.,...,550.},]
				\clip(-150.,-150.) rectangle (850.,550.);
				\draw [line width=1.pt,domain=-150.:850.] plot(\x,{(--240000.-300.*\x)/600.});
				\draw (200.,225.) node {$y=-\frac{1}{2}x+400$};
				\draw[color=red] (0.,400.) node {$ \bullet $};
				\draw (85.,414.) node {$S=(0,400)$};
				\draw[color=blue] (600.,100.) node {$ \bullet $};
				\draw (505.,80.) node {$R=(600,100)$};
				\draw[color=green] (200.,300.) node {$ \bullet $};
				\draw (305.,313.) node {$s_1=(200,300)$};
				\draw[color=green] (400.,200.) node {$ \bullet $};
				\draw (506.,213.) node {$s_2=(400,200)$};
				\draw[color=yellow] (800.,0.) node {$ \bullet $};
				\draw (775.,70.) node {$s_3=(800,0)$};
				\end{axis}
			\end{tikzpicture}
		\end{adjustbox}
		\caption{Erweiterung des Geheimnisses $ S $ als Gerade $ f $ für zwei Shares $s_1$ und $s_2$.} % TODO Caption
	\end{figure}

	\subsection{$ (3,n) $-Schema}
		Blah % TODO (3,n) $-Schema
		
	\begin{figure}[h]
		\begin{adjustbox}{center}
			\begin{tikzpicture}[line cap=round,line join=round,>=triangle 45,x=0.015cm,y=0.015cm]
			\begin{axis}[x=0.015cm,y=0.015cm,axis lines=middle,ymajorgrids=true,xmajorgrids=true,
			xmin=-150.,xmax=850.,xtick={-100.,0.,...,850.},
			ymin=-150.,ymax=550.,ytick={-100.,0.,...,550.},]
			\clip(-150.,-150.) rectangle (850.,550.);
			\draw[line width=1.pt,smooth,samples=100,domain=-150.0:850.0] plot(\x,{0.0025*(\x)^(2.0)-1.75*(\x)+400.0});
			\draw[color=red] (0.,400.) node {$ \bullet $};
			\draw (85.,414.) node {$S=(0,400)$};
			\draw[color=blue] (100.,250.) node {$ \bullet $};
			\draw (205.,264.) node {$R_1=(100,250)$};
			\draw[color=blue] (600.,250.) node {$ \bullet $};
			\draw (715.,264.) node {$R_2=(600,250)$};
			\draw (580.,480.) node {$y=\frac{1}{400}x^2-1,75x+400$};
			\draw[color=green] (200.,150.) node {$ \bullet $};
			\draw (305.,163.) node {$s_1=(200,150)$};
			\draw[color=green] (300.,100.) node {$ \bullet $};
			\draw (305.,73.) node {$s_2=(300,100)$};
			\draw[color=green] (500.,150.) node {$ \bullet $};
			\draw (625.,163.) node {$s_3=(500,150)$};
			\draw[color=yellow] (700.,400.) node {$ \bullet $};
			\draw (585.,380.) node {$s_4=(700,400)$};
			\end{axis}
			\end{tikzpicture}
		\end{adjustbox}
		\caption{Parabel} % TODO Caption
	\end{figure}

	\subsection{Allgemeine $ (k,n) $-Schemata}
		Blah % TODO (k,n) $-Schema
	
	\subsection{Shamir's Secret Sharing $ x \bmod p $}
		Blah % TODO Shamir mod p

	\section{Weitere Verfahren}
		Blah % TODO Weitere Verfahren
		
	\subsection{Blakeley's}
		Blah % TODO Blakeley's
		
	\subsection{whatever\dots}
		Blah % TODO Whatever
	
	\section{Fazit}
	
	\cleardoublepage
	\phantomsection
	\addcontentsline{toc}{chapter}{Abbildungsverzeichnis}
	\listoffigures
	\begingroup
	\let\clearpage\relax
	\phantomsection
	\addcontentsline{toc}{chapter}{Literaturverzeichnis}
	\bibliographystyle{acm} % siam, alpha, alphadin, ieeetr, plain, acm, abbrvdin
	\bibliography{secret-sharing}
	\endgroup
\end{document}
